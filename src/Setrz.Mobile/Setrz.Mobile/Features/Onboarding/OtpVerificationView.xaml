<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Setrz.Mobile.Features.Onboarding"
             xmlns:views="using:Setrz.Mobile.Shared.Views"
             x:Class="Setrz.Mobile.Features.Onboarding.OtpVerificationView"
             x:DataType="{vm:OtpVerificationViewModel}">
    <Grid>
        <views:LoaderView/>
        <VerticalStackLayout Spacing="25" Padding="30" VerticalOptions="Center">

        <Label Text="OTP Verification"
               FontSize="28"
               FontAttributes="Bold"
               HorizontalOptions="Center" />

        <Label Text="{Binding VerificationMessage}"
               HorizontalOptions="Center"
               TextColor="Gray"
               FontSize="16" />

        <Border Stroke="LightGray"
                StrokeThickness="1"
                Padding="0"
                Margin="0, 10, 0, 10">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="8" />
            </Border.StrokeShape>

            <Entry Placeholder="Enter 6-digit OTP"
                   Keyboard="Numeric"
                   MaxLength="6"
                   HorizontalTextAlignment="Center"
                   Margin="15,0"
                   FontSize="22"
                   Text="{Binding OtpCode, Mode=TwoWay}" />
        </Border>

        <Button Text="Verify and Proceed"
                CornerRadius="8"
                HeightRequest="50"
                Command="{Binding VerifyOtpCommand}">
            <VisualStateManager.VisualStateGroups>
                    <VisualStateGroupList>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="Disabled">
                                <VisualState.Setters>
                                    <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource Gray950}, Dark={StaticResource Gray200}}" />
                                    <Setter Property="BackgroundColor" Value="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}" />
                                </VisualState.Setters>
                            </VisualState>
                            <VisualState x:Name="Normal">
                                <VisualState.Setters>
                                    <Setter Property="TextColor" Value="White" />
                                    <Setter Property="BackgroundColor" Value="#FF5722" />
                                </VisualState.Setters>
                            </VisualState>
                            <VisualState x:Name="PointerOver">
                                <VisualState.Setters>
                                    <Setter Property="BackgroundColor" Value="{AppThemeBinding 
                                    Light={StaticResource Tertiary}, 
                                    Dark={StaticResource SecondaryDarkText}}" /> 
                                </VisualState.Setters>
                            </VisualState>
                            <VisualState x:Name="Pressed">
                                <VisualState.Setters>
                                    <Setter Property="BackgroundColor" Value="{AppThemeBinding 
                                    Light={StaticResource Tertiary}, 
                                    Dark={StaticResource Primary}}" />
                                    <Setter Property="Scale" Value="0.98" /> 
                                </VisualState.Setters>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateGroupList>
                </VisualStateManager.VisualStateGroups>
        </Button>

        <HorizontalStackLayout HorizontalOptions="Center" Margin="0, 10, 0, 0">
            <Label Text="Didn't receive code?" TextColor="Gray" />
            <Button Text="Resend" 
                    StyleClass="TextButton" 
                    TextColor="#007ACC" 
                    Margin="10 0 0 0"
                    Command="{Binding ResendOtpCommand}" />
        </HorizontalStackLayout>
        
    </VerticalStackLayout>
    </Grid>
</ContentPage>